{"mappings":"gfAAA,IAEMA,EAAkB,IAAI,EAF5BC,EAAA,SAE4BC,iBACtBC,EAAY,mCACZC,EAAO,CACXC,QAASC,SAASC,cAAc,YAChCC,QAASF,SAASC,cAAc,aAKlC,SAASE,EAAmBC,GAC1BA,EAAEC,iBACED,EAAEE,OAAOC,WAAWC,QAAQC,MAWlC,WACE,GAAIT,SAASC,cAAc,aACzB,OAEFH,EAAKC,QAAQW,mBACX,YACC,6HAMHZ,EAAKa,MAAQX,SAASC,cAAc,aACpCH,EAAKc,SAAWZ,SAASC,cAAc,iB,CAtBrCY,GA6GFf,EAAKa,MAAMG,iBAAiB,SAAS,SAAAV,IAC/BA,EAAEE,OAAOS,UAAUC,SAAS,aAErBZ,EAAEE,OAAOS,UAAUC,SAAS,iBADrCC,G,IAQJjB,SAASc,iBAAiB,UAAWI,GApHnCxB,EAAgByB,QAAUf,EAAEE,OAAOC,WAAWC,QAAQC,GAwBxDf,EAAgB0B,aAAaC,MAAK,SAAAC,GAC3BA,GAUT,SAAoBA,GAClB,IACEC,EAQED,EARFC,eACAC,EAOEF,EAPFE,YACAC,EAMEH,EANFG,MACAC,EAKEJ,EALFI,aACAC,EAIEL,EAJFK,WACAC,EAGEN,EAHFM,SACAC,EAEEP,EAFFO,OACAC,EACER,EADFQ,WAGIC,EAAS,+IAKHC,OADRnC,EAAY2B,EACb,WACgCQ,OADvBP,EAAM,2CAmB0CO,OAlBzBP,EAAM,klBAoBDO,OAFoBN,EAAaO,QACjE,GACA,kCAGiCD,OAHDL,EAAWM,UAAU,+FAMdD,OAHNF,EAAWG,QAAQ,GAAG,8FAMtBD,OAHMT,EAAe,wFASzBS,OANIH,EAAO,GAAGK,KAAK,kIAMVF,OAATJ,EAAS,wQAS9C5B,SAASC,cAAc,kBAAkBkC,UAAYJ,C,CArEnDK,CAAWd,E,IA1BXxB,EAAKC,QAAQsC,oBAAoB,QAASlC,G,CAmG9C,SAASc,IACPnB,EAAKC,QAAQe,iBAAiB,QAASX,GACvCL,EAAKa,MAAM2B,Q,CAgBb,SAASpB,EAAWd,GACH,WAAXA,EAAEmC,OACJtB,IACAjB,SAASqC,oBAAoB,UAAWnB,G,CAnI5CpB,EAAKC,QAAQe,iBAAiB,QAASX,E","sources":["src/js/modal.js"],"sourcesContent":["import { FilmsApiService } from './search-api';\n\nconst filmsApiService = new FilmsApiService();\nconst IMAGE_URL = 'https://image.tmdb.org/t/p/w500/';\nconst refs = {\n  gallery: document.querySelector('.gallery'),\n  spinner: document.querySelector('.loading'),\n};\n\nrefs.gallery.addEventListener('click', onGalleryItemClick);\n\nfunction onGalleryItemClick(e) {\n  e.preventDefault();\n  if (e.target.parentNode.dataset.id) {\n    // refs.spinner.classList.remove('visually-hidden');\n    createModal();\n    addListenerOnClickClose();\n    addListenerOnKeyClose();\n    filmsApiService.movieId = e.target.parentNode.dataset.id;\n    getFilmInfo();\n    refs.gallery.removeEventListener('click', onGalleryItemClick);\n  }\n}\n\nfunction createModal() {\n  if (document.querySelector('.js-modal')) {\n    return;\n  }\n  refs.gallery.insertAdjacentHTML(\n    'beforeend',\n    `<div class=\"js-modal modal\">\n        <div class=\"js-modal__box modal__box\">\n            \n        </div>\n      </div >`\n  );\n  refs.modal = document.querySelector('.js-modal');\n  refs.modalBox = document.querySelector('.js-modal__box');\n}\n\n//====================================================================\nfunction getFilmInfo() {\n  filmsApiService.getInfoApi().then(data => {\n    if (!data) {\n      return;\n    }\n    makeMarkup(data);\n    // refs.spinner.classList.add('visually-hidden');\n  });\n}\n\n//====================================================================\n\nfunction makeMarkup(data) {\n  const {\n    original_title,\n    poster_path,\n    title,\n    vote_average,\n    vote_count,\n    overview,\n    genres,\n    popularity,\n  } = data;\n\n  const markup = `<button class=\"modal__icon link button\">\n            </button>\n      <div class=\"film-detail\">\n    <img class=\"film-detail__poster\" src=\"${\n      IMAGE_URL + poster_path\n    }\" alt=\"${title}\">\n    <h3 class=\"film-detail__title\">${title}</h3>\n    <div class=\"film-detail__info\">\n    <ul class=\"film-detail__labels list\">\n        <li>\n            <p class=\"film-detail__label\">Vote / Votes</p>\n            </li>\n            <li>\n            <p class=\"film-detail__label\">Popularity</p>\n            </li>\n            <li>\n            <p class=\"film-detail__label\">Original Title</p>\n            </li>\n            <li>\n            <p class=\"film-detail__label\">Genre</p>\n        </li>\n    </ul>\n        <ul class=\"film-detail__data list\">\n        <li>\n        <p class=\"film-detail__meta del\"><span class=\"vote\">${vote_average.toFixed(\n          1\n        )}</span> / <span class=\"votes\">${vote_count.toFixed()}</span></p>\n            </li>\n            <li>\n            <p class=\"film-detail__meta\">${popularity.toFixed(1)}</p>\n            </li>\n            <li>\n            <p class=\"film-detail__meta title\">${original_title}</p>\n            </li>\n            <li>\n            <p class=\"film-detail__meta\">${genres[0].name}</p>\n        </li>\n    </ul>\n</div>\n\n    <h4 class=\"film-detail__about\">ABOUT</h4>\n    <p class=\"film-detail__overview\">${overview}</p>\n    <ul class=\"film-detail buttons\">\n        <li><button type=\"button\" class=\"film-detail__link\">add to Watched</button>\n        </li>\n        <li><button  type=\"button\" class=\"film-detail__link\">add to queue</button>\n        </li>\n    </ul>\n</div>`;\n\n  document.querySelector('.js-modal__box').innerHTML = markup;\n}\n\n//====================================================================\nfunction closeModal() {\n  refs.gallery.addEventListener('click', onGalleryItemClick);\n  refs.modal.remove();\n}\nfunction addListenerOnClickClose() {\n  refs.modal.addEventListener('click', e => {\n    if (e.target.classList.contains('js-modal')) {\n      closeModal();\n    } else if (e.target.classList.contains('modal__icon')) {\n      closeModal();\n    }\n  });\n}\n\nfunction addListenerOnKeyClose() {\n  document.addEventListener('keydown', onKeyClose);\n}\n\nfunction onKeyClose(e) {\n  if (e.code === 'Escape') {\n    closeModal();\n    document.removeEventListener('keydown', onKeyClose);\n  }\n}\n"],"names":["$40873ecf3c18e122$var$filmsApiService","parcelRequire","FilmsApiService","$40873ecf3c18e122$var$IMAGE_URL","$40873ecf3c18e122$var$refs","gallery","document","querySelector","spinner","$40873ecf3c18e122$var$onGalleryItemClick","e","preventDefault","target","parentNode","dataset","id","insertAdjacentHTML","modal","modalBox","$40873ecf3c18e122$var$createModal","addEventListener","classList","contains","$40873ecf3c18e122$var$closeModal","$40873ecf3c18e122$var$onKeyClose","movieId","getInfoApi","then","data","original_title","poster_path","title","vote_average","vote_count","overview","genres","popularity","markup","concat","toFixed","name","innerHTML","$40873ecf3c18e122$var$makeMarkup","removeEventListener","remove","code"],"version":3,"file":"index.54308ee1.js.map"}