{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,S,aAGA,MAAMC,EAAkB,IAAI,EAAAF,EAAAG,iBACtBC,EAAW,IAAI,EAAAC,EAAAC,WAGR,CACXC,QAASC,SAASC,cAAc,YAChCC,QAASF,SAASC,cAAc,cAG7BF,QAAQI,iBAAiB,SAE9B,SAA4BC,GAE1B,GADAA,EAAEC,iBACED,EAAEE,OAAOC,QAAQ,oBAAqB,CACxC,MAAMC,EAAYJ,EAAEE,OAAOC,QAAQ,MAEnCX,EAASa,cACTb,EAASc,0BACTd,EAASe,wBACTjB,EAAgBkB,QAAUJ,EAAUK,GAqCtCnB,EAAgBoB,aAAaC,MAAKC,IAC3BA,GAUT,SAAoBA,GAClB,MAAMC,eACJA,EAAcC,YACdA,EAAWC,MACXA,EAAKC,aACLA,EAAYC,WACZA,EAAUC,SACVA,EAAQC,OACRA,EAAMC,WACNA,GACER,EAEES,EAAS,gFA5EC,mCA+EAP,WACJC,2CACuBA,klBAkByBC,EAAaM,QACjE,mCACgCL,EAAWK,uGAGVF,EAAWE,QAAQ,+FAGbT,wFAGNM,EAAO,GAAGI,qIAMdL,wQASrC1B,EAASgC,SAASC,WAAaJ,C,CApE7BK,CAAWd,EAAK,G","sources":["src/js/details_modal.js"],"sourcesContent":["import { FilmsApiService } from './search-api';\nimport { ModalBox } from './pure_modal';\n\nconst filmsApiService = new FilmsApiService();\nconst modalBox = new ModalBox();\n\nconst IMAGE_URL = 'https://image.tmdb.org/t/p/w500/';\nconst refs = {\n  gallery: document.querySelector('.gallery'),\n  spinner: document.querySelector('.loading'),\n};\n\nrefs.gallery.addEventListener('click', onGalleryItemClick);\n\nfunction onGalleryItemClick(e) {\n  e.preventDefault();\n  if (e.target.closest('li.gallery__item')) {\n    const elementId = e.target.closest('li');\n    // refs.spinner.classList.remove('visually-hidden');\n    modalBox.createModal();\n    modalBox.addListenerOnClickClose();\n    modalBox.addListenerOnKeyClose();\n    filmsApiService.movieId = elementId.id;\n    getFilmInfo();\n    // refs.gallery.removeEventListener('click', onGalleryItemClick);\n  }\n}\n// function onGalleryItemClick(e) {\n//   e.preventDefault();\n//   if (e.target.closest('li')) {\n//     const elementId = e.target.closest('li');\n//     // refs.spinner.classList.remove('visually-hidden');\n//     createModal();\n//     addListenerOnClickClose();\n//     addListenerOnKeyClose();\n//     filmsApiService.movieId = elementId.id;\n//     getFilmInfo();\n//     refs.gallery.removeEventListener('click', onGalleryItemClick);\n//   }\n// }\n\n// function createModal() {\n//   if (document.querySelector('.js-modal')) {\n//     return;\n//   }\n//   refs.gallery.insertAdjacentHTML(\n//     'beforeend',\n//     `<div class=\"js-modal modal\">\n//         <div class=\"js-modal__box modal__box\">\n\n//         </div>\n//       </div >`\n//   );\n//   refs.modal = document.querySelector('.js-modal');\n//   refs.modalBox = document.querySelector('.js-modal__box');\n// }\n\n//====================================================================\nfunction getFilmInfo() {\n  filmsApiService.getInfoApi().then(data => {\n    if (!data) {\n      return;\n    }\n    makeMarkup(data);\n    // refs.spinner.classList.add('visually-hidden');\n  });\n}\n\n//====================================================================\n\nfunction makeMarkup(data) {\n  const {\n    original_title,\n    poster_path,\n    title,\n    vote_average,\n    vote_count,\n    overview,\n    genres,\n    popularity,\n  } = data;\n\n  const markup = `\n      <div class=\"film-detail\">\n    <img class=\"film-detail__poster\" src=\"${\n      IMAGE_URL + poster_path\n    }\" alt=\"${title}\">\n    <h3 class=\"film-detail__title\">${title}</h3>\n    <div class=\"film-detail__info\">\n    <ul class=\"film-detail__labels list\">\n        <li>\n            <p class=\"film-detail__label\">Vote / Votes</p>\n            </li>\n            <li>\n            <p class=\"film-detail__label\">Popularity</p>\n            </li>\n            <li>\n            <p class=\"film-detail__label\">Original Title</p>\n            </li>\n            <li>\n            <p class=\"film-detail__label\">Genre</p>\n        </li>\n    </ul>\n        <ul class=\"film-detail__data list\">\n        <li>\n        <p class=\"film-detail__meta del\"><span class=\"vote\">${vote_average.toFixed(\n          1\n        )}</span> / <span class=\"votes\">${vote_count.toFixed()}</span></p>\n            </li>\n            <li>\n            <p class=\"film-detail__meta\">${popularity.toFixed(1)}</p>\n            </li>\n            <li>\n            <p class=\"film-detail__meta title\">${original_title}</p>\n            </li>\n            <li>\n            <p class=\"film-detail__meta\">${genres[0].name}</p>\n        </li>\n    </ul>\n</div>\n\n    <h4 class=\"film-detail__about\">ABOUT</h4>\n    <p class=\"film-detail__overview\">${overview}</p>\n    <ul class=\"film-detail buttons\">\n        <li><button type=\"button\" class=\"film-detail__link\">add to Watched</button>\n        </li>\n        <li><button  type=\"button\" class=\"film-detail__link\">add to queue</button>\n        </li>\n    </ul>\n</div>`;\n\n  modalBox.modalBox.innerHTML += markup;\n}\n\n//====================================================================\n// function closeModal() {\n//   refs.gallery.addEventListener('click', onGalleryItemClick);\n//   refs.modal.remove();\n// }\n// function addListenerOnClickClose() {\n//   refs.modal.addEventListener('click', e => {\n//     if (e.target.classList.contains('js-modal')) {\n//       closeModal();\n//     } else if (e.target.classList.contains('modal__icon')) {\n//       closeModal();\n//     }\n//   });\n// }\n\n// function addListenerOnKeyClose() {\n//   document.addEventListener('keydown', onKeyClose);\n// }\n\n// function onKeyClose(e) {\n//   if (e.code === 'Escape') {\n//     closeModal();\n//     document.removeEventListener('keydown', onKeyClose);\n//   }\n// }\n"],"names":["$arR5w","parcelRequire","$c8e3c98155229a50$var$filmsApiService","FilmsApiService","$c8e3c98155229a50$var$modalBox","$cDNNI","ModalBox","gallery","document","querySelector","spinner","addEventListener","e","preventDefault","target","closest","elementId","createModal","addListenerOnClickClose","addListenerOnKeyClose","movieId","id","getInfoApi","then","data","original_title","poster_path","title","vote_average","vote_count","overview","genres","popularity","markup","toFixed","name","modalBox","innerHTML","$c8e3c98155229a50$var$makeMarkup"],"version":3,"file":"index.9ea9501a.js.map"}